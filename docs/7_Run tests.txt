2025-08-26T12:57:19.9571153Z ##[group]Run poetry run pytest -q
2025-08-26T12:57:19.9571464Z [36;1mpoetry run pytest -q[0m
2025-08-26T12:57:19.9611025Z shell: /usr/bin/bash -e {0}
2025-08-26T12:57:19.9611244Z env:
2025-08-26T12:57:19.9611430Z   PIP_DISABLE_PIP_VERSION_CHECK: 1
2025-08-26T12:57:19.9611674Z   PYTHONUNBUFFERED: 1
2025-08-26T12:57:19.9612154Z   CRAWLER_MIN_RECORDS: 5
2025-08-26T12:57:19.9612444Z   TZ: Asia/Tokyo
2025-08-26T12:57:19.9612701Z   pythonLocation: /opt/hostedtoolcache/Python/3.10.18/x64
2025-08-26T12:57:19.9613102Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.10.18/x64/lib/pkgconfig
2025-08-26T12:57:19.9613488Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.18/x64
2025-08-26T12:57:19.9613830Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.18/x64
2025-08-26T12:57:19.9614185Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.10.18/x64
2025-08-26T12:57:19.9614530Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.10.18/x64/lib
2025-08-26T12:57:19.9614820Z ##[endgroup]
2025-08-26T12:58:08.3390959Z ...........F.F                                                           [100%]
2025-08-26T12:58:08.3391910Z =================================== FAILURES ===================================
2025-08-26T12:58:08.3393913Z ________________________ test_structure_minimum_counts _________________________
2025-08-26T12:58:08.3394354Z 
2025-08-26T12:58:08.3394577Z     def test_structure_minimum_counts() -> None:
2025-08-26T12:58:08.3395089Z         rec = load_record("sample_minutes_01.json")
2025-08-26T12:58:08.3395531Z         ms = extract_minutes_structure(rec)
2025-08-26T12:58:08.3395999Z >       assert len(ms.agenda_items) >= 2
2025-08-26T12:58:08.3396469Z E       AssertionError: assert 1 >= 2
2025-08-26T12:58:08.3398371Z E        +  where 1 = len([AgendaItem(title='（議題なし）', order_no=1, speeches=[Speech(speaker='中妻穣太', role='委員', paragraphs=['お伺いします。\n続けて質問します。'])...中太郎', role='議員', paragraphs=['給食無償化について。\n継続審議とするべきでは。']), Speech(speaker='委員長', role='委員長', paragraphs=['次に進みます。'])])])
2025-08-26T12:58:08.3403451Z E        +    where [AgendaItem(title='（議題なし）', order_no=1, speeches=[Speech(speaker='中妻穣太', role='委員', paragraphs=['お伺いします。\n続けて質問します。'])...中太郎', role='議員', paragraphs=['給食無償化について。\n継続審議とするべきでは。']), Speech(speaker='委員長', role='委員長', paragraphs=['次に進みます。'])])] = MinutesStructure(meeting_date='2025-08-21', committee='文教児童委員会', page_url='https://example.local/itabashi/minutes/2025...太郎', role='議員', paragraphs=['給食無償化について。\n継続審議とするべきでは。']), Speech(speaker='委員長', role='委員長', paragraphs=['次に進みます。'])])]).agenda_items
2025-08-26T12:58:08.3405696Z 
2025-08-26T12:58:08.3405944Z tests/test_structure_extractor.py:18: AssertionError
2025-08-26T12:58:08.3406574Z ___________________________ test_structure_snapshot ____________________________
2025-08-26T12:58:08.3406970Z 
2025-08-26T12:58:08.3407080Z     def test_structure_snapshot() -> None:
2025-08-26T12:58:08.3407452Z         rec_path = Path("tests/fixtures/sample_minutes_01.json")
2025-08-26T12:58:08.3407871Z         snap_path = Path("tests/fixtures/snapshots/structure_sample01.json")
2025-08-26T12:58:08.3408276Z         rec = json.loads(rec_path.read_text(encoding="utf-8"))
2025-08-26T12:58:08.3408585Z         ms = extract_minutes_structure(rec)
2025-08-26T12:58:08.3408842Z         current = ms.model_dump()
2025-08-26T12:58:08.3409147Z         expected = json.loads(snap_path.read_text(encoding="utf-8"))
2025-08-26T12:58:08.3409497Z >       assert current == expected
2025-08-26T12:58:08.3409872Z E       AssertionError: assert {'agenda_item...-bunkyo', ...} == {'agenda_item...-bunkyo', ...}
2025-08-26T12:58:08.3410244Z E         
2025-08-26T12:58:08.3410453Z E         Omitting 4 identical items, use -vv to show
2025-08-26T12:58:08.3410721Z E         Differing items:
2025-08-26T12:58:08.3412280Z E         {'agenda_items': [{'order_no': 1, 'speeches': [{'paragraphs': ['お伺いします。\n続けて質問します。'], 'role': '委員', 'speaker': '中妻穣太'}..., 'role': '議員', 'speaker': '田中太郎'}, {'paragraphs': ['次に進みます。'], 'role': '委員長', 'speaker': '委員長'}], 'title': '（議題なし）'}]} != {'agenda_items': [{'order_no': 1, 'speeches': [{'paragraphs': ['お伺いします。\n続けて質問します。'], 'role': '委員', 'speaker': '中妻穣太'}...: '議員', 'speaker': '田中太郎'}, {'paragraphs': ['次に進みます。'], 'role': '委員長', 'speaker': '委員長'}], 'title': '【議題２ 学校給食について】'}]}
2025-08-26T12:58:08.3413499Z E         
2025-08-26T12:58:08.3413664Z E         Full diff:
2025-08-26T12:58:08.3413844Z E           {
2025-08-26T12:58:08.3414015Z E               'agenda_items': [
2025-08-26T12:58:08.3414233Z E                   {
2025-08-26T12:58:08.3414428Z E                       'order_no': 1,
2025-08-26T12:58:08.3414661Z E                       'speeches': [
2025-08-26T12:58:08.3414889Z E                           {
2025-08-26T12:58:08.3415125Z E                               'paragraphs': [
2025-08-26T12:58:08.3415459Z E                                   'お伺いします。\n'
2025-08-26T12:58:08.3415762Z E                                   '続けて質問します。',
2025-08-26T12:58:08.3416007Z E                               ],
2025-08-26T12:58:08.3416292Z E                               'role': '委員',
2025-08-26T12:58:08.3416591Z E                               'speaker': '中妻穣太',
2025-08-26T12:58:08.3416870Z E                           },
2025-08-26T12:58:08.3417073Z E                           {
2025-08-26T12:58:08.3417287Z E                               'paragraphs': [
2025-08-26T12:58:08.3417585Z E                                   'ご答弁いたします。\n'
2025-08-26T12:58:08.3417872Z E                                   '対応します。',
2025-08-26T12:58:08.3418102Z E                               ],
2025-08-26T12:58:08.3418361Z E                               'role': '教育長',
2025-08-26T12:58:08.3418645Z E                               'speaker': '教育長',
2025-08-26T12:58:08.3418880Z E                           },
2025-08-26T12:58:08.3419074Z E                           {
2025-08-26T12:58:08.3419286Z E                               'paragraphs': [
2025-08-26T12:58:08.3419720Z E                                   '補足します。',
2025-08-26T12:58:08.3420007Z E         +                         '【議題２ 学校給食について】',
2025-08-26T12:58:08.3420260Z E                               ],
2025-08-26T12:58:08.3420529Z E                               'role': '理事者',
2025-08-26T12:58:08.3420810Z E                               'speaker': '理事者',
2025-08-26T12:58:08.3421046Z E                           },
2025-08-26T12:58:08.3421244Z E         -             ],
2025-08-26T12:58:08.3421507Z E         -             'title': '【議題１ 教育行政について】',
2025-08-26T12:58:08.3421929Z E         -         },
2025-08-26T12:58:08.3422120Z E         -         {
2025-08-26T12:58:08.3422311Z E         -             'order_no': 2,
2025-08-26T12:58:08.3422554Z E         -             'speeches': [
2025-08-26T12:58:08.3422782Z E                           {
2025-08-26T12:58:08.3423002Z E                               'paragraphs': [
2025-08-26T12:58:08.3423312Z E                                   '給食無償化について。\n'
2025-08-26T12:58:08.3423696Z E                                   '継続審議とするべきでは。',
2025-08-26T12:58:08.3423969Z E                               ],
2025-08-26T12:58:08.3424239Z E                               'role': '議員',
2025-08-26T12:58:08.3424537Z E                               'speaker': '田中太郎',
2025-08-26T12:58:08.3424777Z E                           },
2025-08-26T12:58:08.3424977Z E                           {
2025-08-26T12:58:08.3425195Z E                               'paragraphs': [
2025-08-26T12:58:08.3425478Z E                                   '次に進みます。',
2025-08-26T12:58:08.3425709Z E                               ],
2025-08-26T12:58:08.3425975Z E                               'role': '委員長',
2025-08-26T12:58:08.3426259Z E                               'speaker': '委員長',
2025-08-26T12:58:08.3426497Z E                           },
2025-08-26T12:58:08.3426696Z E                       ],
2025-08-26T12:58:08.3426949Z E         -             'title': '【議題２ 学校給食について】',
2025-08-26T12:58:08.3427208Z E         ?                       ^  ^^^^^^^^^^^
2025-08-26T12:58:08.3427498Z E         +             'title': '（議題なし）',
2025-08-26T12:58:08.3427731Z E         ?                       ^  ^^^
2025-08-26T12:58:08.3428107Z E                   },
2025-08-26T12:58:08.3428285Z E               ],
2025-08-26T12:58:08.3428520Z E               'committee': '文教児童委員会',
2025-08-26T12:58:08.3428761Z E               'meeting_date': '2025-08-21',
2025-08-26T12:58:08.3429114Z E               'page_url': 'https://example.local/itabashi/minutes/2025-08-21-bunkyo',
2025-08-26T12:58:08.3429538Z E               'pdf_url': 'https://example.local/itabashi/minutes/sample.pdf',
2025-08-26T12:58:08.3429846Z E           }
2025-08-26T12:58:08.3429951Z 
2025-08-26T12:58:08.3430080Z tests/test_structure_snapshot.py:16: AssertionError
2025-08-26T12:58:08.3430400Z =========================== short test summary info ============================
2025-08-26T12:58:08.3430930Z FAILED tests/test_structure_extractor.py::test_structure_minimum_counts - AssertionError: assert 1 >= 2
2025-08-26T12:58:08.3432249Z  +  where 1 = len([AgendaItem(title='（議題なし）', order_no=1, speeches=[Speech(speaker='中妻穣太', role='委員', paragraphs=['お伺いします。\n続けて質問します。'])...中太郎', role='議員', paragraphs=['給食無償化について。\n継続審議とするべきでは。']), Speech(speaker='委員長', role='委員長', paragraphs=['次に進みます。'])])])
2025-08-26T12:58:08.3434308Z  +    where [AgendaItem(title='（議題なし）', order_no=1, speeches=[Speech(speaker='中妻穣太', role='委員', paragraphs=['お伺いします。\n続けて質問します。'])...中太郎', role='議員', paragraphs=['給食無償化について。\n継続審議とするべきでは。']), Speech(speaker='委員長', role='委員長', paragraphs=['次に進みます。'])])] = MinutesStructure(meeting_date='2025-08-21', committee='文教児童委員会', page_url='https://example.local/itabashi/minutes/2025...太郎', role='議員', paragraphs=['給食無償化について。\n継続審議とするべきでは。']), Speech(speaker='委員長', role='委員長', paragraphs=['次に進みます。'])])]).agenda_items
2025-08-26T12:58:08.3435883Z FAILED tests/test_structure_snapshot.py::test_structure_snapshot - AssertionError: assert {'agenda_item...-bunkyo', ...} == {'agenda_item...-bunkyo', ...}
2025-08-26T12:58:08.3436602Z   
2025-08-26T12:58:08.3436790Z   Omitting 4 identical items, use -vv to show
2025-08-26T12:58:08.3437032Z   Differing items:
2025-08-26T12:58:08.3438317Z   {'agenda_items': [{'order_no': 1, 'speeches': [{'paragraphs': ['お伺いします。\n続けて質問します。'], 'role': '委員', 'speaker': '中妻穣太'}..., 'role': '議員', 'speaker': '田中太郎'}, {'paragraphs': ['次に進みます。'], 'role': '委員長', 'speaker': '委員長'}], 'title': '（議題なし）'}]} != {'agenda_items': [{'order_no': 1, 'speeches': [{'paragraphs': ['お伺いします。\n続けて質問します。'], 'role': '委員', 'speaker': '中妻穣太'}...: '議員', 'speaker': '田中太郎'}, {'paragraphs': ['次に進みます。'], 'role': '委員長', 'speaker': '委員長'}], 'title': '【議題２ 学校給食について】'}]}
2025-08-26T12:58:08.3439317Z   
2025-08-26T12:58:08.3439473Z   Full diff:
2025-08-26T12:58:08.3439631Z     {
2025-08-26T12:58:08.3439798Z         'agenda_items': [
2025-08-26T12:58:08.3439994Z             {
2025-08-26T12:58:08.3440162Z                 'order_no': 1,
2025-08-26T12:58:08.3440392Z                 'speeches': [
2025-08-26T12:58:08.3440592Z                     {
2025-08-26T12:58:08.3440787Z                         'paragraphs': [
2025-08-26T12:58:08.3441063Z                             'お伺いします。\n'
2025-08-26T12:58:08.3441462Z                             '続けて質問します。',
2025-08-26T12:58:08.3441840Z                         ],
2025-08-26T12:58:08.3442118Z                         'role': '委員',
2025-08-26T12:58:08.3442396Z                         'speaker': '中妻穣太',
2025-08-26T12:58:08.3442621Z                     },
2025-08-26T12:58:08.3442796Z                     {
2025-08-26T12:58:08.3442984Z                         'paragraphs': [
2025-08-26T12:58:08.3443259Z                             'ご答弁いたします。\n'
2025-08-26T12:58:08.3443519Z                             '対応します。',
2025-08-26T12:58:08.3443737Z                         ],
2025-08-26T12:58:08.3443974Z                         'role': '教育長',
2025-08-26T12:58:08.3444242Z                         'speaker': '教育長',
2025-08-26T12:58:08.3444460Z                     },
2025-08-26T12:58:08.3444646Z                     {
2025-08-26T12:58:08.3444832Z                         'paragraphs': [
2025-08-26T12:58:08.3445088Z                             '補足します。',
2025-08-26T12:58:08.3445369Z   +                         '【議題２ 学校給食について】',
2025-08-26T12:58:08.3445596Z                         ],
2025-08-26T12:58:08.3445825Z                         'role': '理事者',
2025-08-26T12:58:08.3446098Z                         'speaker': '理事者',
2025-08-26T12:58:08.3446321Z                     },
2025-08-26T12:58:08.3446490Z   -             ],
2025-08-26T12:58:08.3446721Z   -             'title': '【議題１ 教育行政について】',
2025-08-26T12:58:08.3446945Z   -         },
2025-08-26T12:58:08.3447107Z   -         {
2025-08-26T12:58:08.3447273Z   -             'order_no': 2,
2025-08-26T12:58:08.3447482Z   -             'speeches': [
2025-08-26T12:58:08.3447680Z                     {
2025-08-26T12:58:08.3447862Z                         'paragraphs': [
2025-08-26T12:58:08.3448138Z                             '給食無償化について。\n'
2025-08-26T12:58:08.3448556Z                             '継続審議とするべきでは。',
2025-08-26T12:58:08.3448780Z                         ],
2025-08-26T12:58:08.3449014Z                         'role': '議員',
2025-08-26T12:58:08.3449291Z                         'speaker': '田中太郎',
2025-08-26T12:58:08.3449505Z                     },
2025-08-26T12:58:08.3449678Z                     {
2025-08-26T12:58:08.3449863Z                         'paragraphs': [
2025-08-26T12:58:08.3450125Z                             '次に進みます。',
2025-08-26T12:58:08.3450336Z                         ],
2025-08-26T12:58:08.3450568Z                         'role': '委員長',
2025-08-26T12:58:08.3450833Z                         'speaker': '委員長',
2025-08-26T12:58:08.3451054Z                     },
2025-08-26T12:58:08.3451227Z                 ],
2025-08-26T12:58:08.3451457Z   -             'title': '【議題２ 学校給食について】',
2025-08-26T12:58:08.3451862Z   ?                       ^  ^^^^^^^^^^^
2025-08-26T12:58:08.3452187Z   +             'title': '（議題なし）',
2025-08-26T12:58:08.3452418Z   ?                       ^  ^^^
2025-08-26T12:58:08.3452614Z             },
2025-08-26T12:58:08.3452775Z         ],
2025-08-26T12:58:08.3452986Z         'committee': '文教児童委員会',
2025-08-26T12:58:08.3453206Z         'meeting_date': '2025-08-21',
2025-08-26T12:58:08.3453537Z         'page_url': 'https://example.local/itabashi/minutes/2025-08-21-bunkyo',
2025-08-26T12:58:08.3453952Z         'pdf_url': 'https://example.local/itabashi/minutes/sample.pdf',
2025-08-26T12:58:08.3454249Z     }
2025-08-26T12:58:08.3454417Z 2 failed, 12 passed in 43.67s
2025-08-26T12:58:08.8245541Z ##[error]Process completed with exit code 1.
