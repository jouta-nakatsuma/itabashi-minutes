Codex 指示 — Step 6: Lint/CI/README（最小変更で整える）
===========================================

ゴール
---

*   コード整形と静的検査の“基準”を明文化し、CIに反映（既存を壊さない最小変更）。
*   README に「構造抽出 → カタログ → API」の最短起動手順と代表クエリを追記。

方針
--

*   **既存のCIがグリーン**であることを尊重し、破壊的変更はしない（lint/format/mypy/pytest は既に通過） Codex-result\_202509071110。
*   フォーマッタは **Black** を既定に。**Ruff** は「導入されていれば使う」方針（未導入なら今回はスキップ）。

変更/追加（最小）
---------

1.  **整形・Lint コマンドを統一**
    *   既に black が入っている前提で以下を README に明記：
        ```bash
        poetry run black .
        poetry run mypy .
        # Ruff が入っている場合
        poetry run ruff check .
        ```
    *   （必要なら）`pyproject.toml` の `[tool.black]` に `line-length = 100`, `target-version = ["py39"]` を追加。
2.  **CI の軽微な足し**
    *   既存ワークフローに `black --check .` を追加（他は現状維持）。  
        Ruff が既に導入されている場合のみ `ruff check .` を追加（無いなら追加しない）。
3.  **README 追記（Quick Start と代表クエリ）**
    *   「最短起動」手順：
        ```bash
        poetry install
        # DB作成（fixturesでOK）
        rm -f var/minutes.db && mkdir -p var
        sqlite3 var/minutes.db < catalog/schema.sql
        poetry run catalog-load --db var/minutes.db --src tests/fixtures
        ```
    *   API 起動と代表クエリ：
        ```bash
        poetry run api-serve --db var/minutes.db --host 127.0.0.1 --port 8000
        # 動作確認
        curl "http://127.0.0.1:8000/search?q=高島平"
        curl "http://127.0.0.1:8000/search?committee=文教児童委員会&date_from=2025-08-01&date_to=2025-08-31"
        curl "http://127.0.0.1:8000/document/1"
        ```
    *   `scripts/rebuild_catalog.py`/`one_shot_apply.py` の使い方も README に短く記載（Step5 で追加済みの内容に沿って整える） Codex-result\_202509071110。

受入基準（DoD）
---------

*   `black --check .` が CI で成功（Ruff は導入済みのときのみチェックを追加）。
*   ローカルで上記 README 手順がコピペで通る（API が起動し、検索が返る）。
*   README に **Quick Start** と代表クエリが追記されている。

実行コマンド（確認用）
-----------

```bash
# 整形
poetry run black .

# 型チェック
poetry run mypy .

# （任意）Ruff 導入済みなら
poetry run ruff check .

# READMEの手順を実行
rm -f var/minutes.db && mkdir -p var
sqlite3 var/minutes.db < catalog/schema.sql
poetry run catalog-load --db var/minutes.db --src tests/fixtures
poetry run api-serve --db var/minutes.db --host 127.0.0.1 --port 8000
```